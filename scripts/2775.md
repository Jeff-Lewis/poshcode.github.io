---
pid:            2775
parent:         2774
children:       2776
poster:         Jeff Patton
title:          Get-SiSReport
date:           2011-07-08 06:57:03
description:    This function returns the sisadmin /v status and basic disk information for a given disk. Oops, copied the whole function library, here is just the aforementioned function!
format:         posh
---

# Get-SiSReport

### [download](2775.ps1) [parent](2774.md) [2776](2776.md)

This function returns the sisadmin /v status and basic disk information for a given disk. Oops, copied the whole function library, here is just the aforementioned function!

```posh
Function Get-SiSReport
{
    <#
        .SYNOPSIS
            Get the overall SIS usage information.
        .DESCRIPTION
            This function uses the sisadmin command to get the usage
            information for a SIS enabled drive.
        .PARAMETER SisDisk
            The drive letter of a disk that has SiS enabled
        .EXAMPLE
            Get-SiSReport -SisDisk o

            LinkFiles             : 20004
            Used                  : 442378481664
            Disk                  : o
            InaccessibleLinkFiles : 0
            CommonStoreFiles      : 6678
            SpaceSaved            : 7708860 KB
            Free                  : 0
            
            Description
            -----------
            This example shows the basic usage of the command

        .NOTES
            This function will return nothing if the drive being analyzed does not have SiS enabled
            This function will return a message if the sisadmin command returns any error
        .LINK
    #>
    
    Param
    (
    $SisDisk = "c"
    )

    Begin
    {
        $SisAdmin = "& sisadmin /v $($SisDisk):"
        Try
        {
            $SisResult = Invoke-Expression $SisAdmin
            }
        Catch
        {
            Return "Single Instance Storage is not available on this computer"
            }
        }

    Process
    {
        If ($SisResult.Count)
        {
            $ThisDisk = Get-PSDrive $SisDisk
            $SisReport = New-Object -TypeName PSObject -Property @{
                Disk = $SisDisk
                Used = $ThisDisk.Used
                Free = $ThisDisk.Free
                CommonStoreFiles = ($SisResult[($SisResult.Count)-4]).TrimStart("Common store files:")
                LinkFiles = ($SisResult[($SisResult.Count)-3]).TrimStart("Link files:")
                InaccessibleLinkFiles = ($SisResult[($SisResult.Count)-2]).TrimStart("Inaccessible link files:")
                SpaceSaved = ($SisResult[($SisResult.Count)-1]).TrimStart("Space saved:")
                }
            }
        }

    End
    {
        Return $SisReport
        }
}
```
