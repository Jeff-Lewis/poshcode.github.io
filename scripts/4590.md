---
pid:            4590
poster:         dfsdiag
title:          Monitor folders
date:           2013-11-07 20:44:52
format:         posh
parent:         0
parent:         0
children:       4591
---

# Monitor folders

### [download](4590.ps1) - children: [4591](4591.md)

Compare files in multiple folders against a reference set to provide an early detection of Cryptolocker

```posh
$cleanDirectory = "C:\CLEAN"
$dirtyDirectory = "C:\DIRTY"
$monitoredFolders = "A", "B", "C"

foreach ($folder in $monitoredFolders) {
    foreach ($file in (gci $dirtyDirectory\$folder)) {
        if (Compare-Object $(gc $dirtyDirectory\$folder\$file) $(gc $cleanDirectory\$folder\$file)) {
            Write-Host "CONTENTS OF $dirtyDirectory\$folder\$file DO NOT MATCH $cleanDirectory\$folder\$file" -ForegroundColor RED
        }
    }
}
```
