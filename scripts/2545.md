---
pid:            2545
poster:         Joel Bennett
title:          group-byobject
date:           2011-03-07 14:11:12
format:         posh
parent:         2544
parent:         2544

---

# group-byobject

### [download](2545.ps1) - [parent](2544.md)

Groups by a set of properties, but rather than return a string as the "name" of the group, teturns one of the original objects with separate properties for each property used to group, and optionally adds _count and _details properties which are the original Count and Group properties returned from group-object.

(In this version: performance tweaks)

```posh
function Group-ByObject {
#.Synopsis
# Groups by a set of properties, returning objects
#.Description
# A wrapper for the built-in Group-Object cmdlet which returns one of the original objects (with separate properties for each property used to group) rather than a simple string representation as the "name" of the group. Optionally adds _count and _details properties which are the original Count and Group properties returned from group-object
#.Example
# Get-Process svchost | Group-ByObject Name, BasePriority -Count
#
# Groups Service Hosts by their BasePriority
#
#.Example
# Get-Process svchost | Group-ByObject Name, BasePriority -Details Id, WS -Count
#
# Groups Service Hosts by their BasePriority
#
#.Parameter InputObject
# The input objects are the items to be grouped
#.Parameter Property
# One or more properties to group on
#.Parameter Details
# One or more properties to collect as an array on the output
#.Parameters Group
# If set, forces all of the grouped items to be included in the _group property
#.Parameters Count
# If set, shows a count of all the grouped items on each group as the _count property
[CmdletBinding()]
param(
  [Parameter(ValueFromPipeline=$true,Mandatory=$true)]
  $InputObject
, 
  [Parameter(Position=0)]
  [object[]]$Property
, 
  [Parameter(Position=1)]
  [object[]]$Details
, 
  [Alias("All","SD")]
  [switch]$Group
, 
  [switch]$Count
)
begin { 
  $InputItems = New-Object Collections.ArrayList 
  $select = $(
     $property
     foreach($d in $details){if($d){
       @{ n="$d"; e=[ScriptBlock]::Create("`$group.group | Select -Expand '$d'")}
     }}
     if ($Count){ @{ n="_count"; e={$group.count} } }
     if ($Group){ @{ n="_group"; e={$group.group} } }
  )
}
process { [void]$InputItems.Add( $InputObject ) }
end {
  foreach($group in $InputItems | Group-Object $property) { 
    $group.Group[0] | Select-Object $select 
  }
}
}

set-alias groupby group-byobject
set-alias grby group-byobject
```
