---
pid:            5674
parent:         5672
children:       
poster:         irvingriveramx
title:          Get-MX
date:           2015-01-08 16:51:58
description:    Returns the priority mail server (SMTP) to send email directly to the SMTP server of a particular domain/email address.  Uses NetCmdlets (get-dns).
format:         posh
---

# Get-MX

### [download](5674.ps1) [parent](5672.md) 

Returns the priority mail server (SMTP) to send email directly to the SMTP server of a particular domain/email address.  Uses NetCmdlets (get-dns).

```posh
#Returns the priority mail server (SMTP) for a particular email address.
function Get-MX {
param([string] $domain = $( Throw "Query required in the format domain.com or email@domain.com.") )
	
	#rip domain out of full email address if necessary:
	if ($domain.IndexOf("@")) { $domain = $domain.SubString($domain.IndexOf("@")+1) } 
	  	
  #get all the MX records for this domain, sorted by descending preference 
  $mxrecords = @(get-dns $domain -type MX | sort-object -Property PREFERENCE -des)
  
  #verify that there are some records
  if ($mxrecords.Length -eq 0) { Throw "No records found." }
  	
  #The correct record is the one with the lowest preference:
  $mxrecords[0].EXCHANGE
}
```
