---
pid:            2231
poster:         St3v3o
title:          Exchange PST Export
date:           2010-09-14 08:34:39
format:         posh
parent:         0
parent:         0
children:       6903
---

# Exchange PST Export

### [download](2231.ps1) - children: [6903](6903.md)

Export 2007/2010 usermailbox to PST located on File Share

```posh
#Load Exchange PS Snapin
If (@(Get-PSSnapin -Registered | Where-Object {$_.Name -eq "Microsoft.Exchange.Management.PowerShell.E2010"} ).count -eq 1) {
    If (@(Get-PSSnapin | Where-Object {$_.Name -eq "Microsoft.Exchange.Management.PowerShell.E2010"} ).count -eq 0) {
         Write-Host "Loading Exchange Snapin Please Wait...."; Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010}
         } 

#Load Exchange PS Snapin
If (@(Get-PSSnapin -Registered | Where-Object {$_.Name -eq "Microsoft.Exchange.Management.PowerShell.Admin"} ).count -eq 1){ 
    If (@(Get-PSSnapin | Where-Object {$_.Name -eq "Microsoft.Exchange.Management.PowerShell.Admin"} ).count -eq 0) {
        Write-Host "Loading Exchange Snapin Please Wait...."; Add-PSSnapin Microsoft.Exchange.Management.PowerShell.Admin}
        }

Write-Host "`n`n`t`t Export Mailbox To PST `n`n"

#Variables
$path = "\\file\share"
$admin = [Environment]::UserName

$list=Read-Host "Do you want to read from a file? (Y/N)"
IF ($list -eq "N") { 
	$user = Read-Host "Enter A User Name"
       Add-MailboxPermission -Identity $user -User $admin -AccessRights  FullAccess
	   Export-Mailbox $user -PSTFolderPath $path\$user.pst -Confirm:$false
       
}
IF ($list -eq "Y") {
    $file = Read-Host "Enter File Path/Name"
	$users = Get-Content $file
	Foreach ($user in $users) {
       #Add-MailboxPermission -Identity $user -User $admin -AccessRights  FullAccess
	   Export-Mailbox $user -PSTFolderPath $path\$user.pst -Confirm:$false
	}
}
```
