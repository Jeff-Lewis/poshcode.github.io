---
pid:            1139
poster:         Chad MIller
title:          LibrarySqlData
date:           2009-05-31 18:26:19
format:         posh
parent:         0
parent:         0

---

# LibrarySqlData

### [download](1139.ps1)

Library defines two simple functions that use ADO.NET to get and set SQL data.

```posh
#######################
function Get-SqlData
{
    param([string]$serverName=$(throw 'serverName is required.'), [string]$databaseName=$(throw 'databaseName is required.'),
          [string]$query=$(throw 'query is required.'))

    Write-Verbose "Get-SqlData serverName:$serverName databaseName:$databaseName query:$query"

    $connString = "Server=$serverName;Database=$databaseName;Integrated Security=SSPI;"
    $da = New-Object "System.Data.SqlClient.SqlDataAdapter" ($query,$connString)
    $dt = New-Object "System.Data.DataTable"
    [void]$da.fill($dt)
    $dt

} #Get-SqlData

#######################
function Set-SqlData
{

     param([string]$serverName=$(throw 'serverName is required.'), [string]$databaseName=$(throw 'databaseName is required.'),
          [string]$query=$(throw 'query is required.'))

    $connString = "Server=$serverName;Database=$databaseName;Integrated Security=SSPI;"
    $conn = new-object System.Data.SqlClient.SqlConnection $connString
    $conn.Open()
    $cmd = new-object System.Data.SqlClient.SqlCommand("$query", $conn)
    [void]$cmd.ExecuteNonQuery()
    $conn.Close()

} #Set-SqlData
```
