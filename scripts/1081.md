---
pid:            1081
parent:         0
children:       
poster:         Peter
title:          
date:           2009-05-06 11:02:02
format:         posh
---

# 

### [download](1081.ps1)"

Code generates a workable replacement for User Profile details web control on the person.aspx page in SharePoint (allows you to customize the resulting generated code)

```posh
	[void]([reflection.assembly]::LoadWithPartialName("Microsoft.office.server"))

	$serverContext = [Microsoft.Office.Server.ServerContext]::Default
	$upm = [Microsoft.Office.Server.UserProfiles.UserProfileManager]$serverContext
@@	$upm.psbase.properties | ? { $_.isvisibleonviewer } | select DisplayName, name, displayorder, managedpropertyname | % { "<SPSWC:ProfilePropertyCheckValue PropertyNames=""$($_.Name)"" runat=""server"" Text=""&lt;tr&gt;&lt;td class=&quot;ms-profilelabel&quot;gt;$($_.DisplayName): &lt;/td&gt;&lt;td width=&quot;65%&quot; valign=&quot;top&quot;&gt;""/><SPSWC:ProfilePropertyValue PropertyName=""$($_.name)"" class=""ms-profilevalue"" runat=""server"" /><SPSWC:ProfilePropertyCheckValue PropertyNames=""$($_.Name)"" runat=""server"" Text=""&lt;/td&gt;&lt;/tr&gt;""/>" } >a.txt; ii a.txt

```
