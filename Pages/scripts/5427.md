---
pid:            5427
author:         Erika
title:          get windows product key
date:           2014-09-14 11:14:50
format:         posh
parent:         5426

---

# get windows product key

### [download](//scripts/5427.ps1) - [parent](//scripts/5426.md)

retrieve the windows product key of a specified machine using WMI

```posh
function Get-ProductKey([String]$Computer = '.') {
  <#
    .NOTES
        Author: greg zakharov
  #>
  begin {
    $val = [Byte[]]([wmiclass]('\\' + $Computer + '\root\default:StdRegProv')).GetBinaryValue(
      2147483650, 'SOFTWARE\Microsoft\Windows NT\CurrentVersion', 'DigitalProductId'
    ).uValue[52..66]
    $map = "BCDFGHJKMPQRTVWXY2346789"
    $key = ""
  }
  process {
    for ($i = 24; $i -ge 0; $i--) {
      $k = 0
      for ($j = 14; $j -ge 0; $j--) {
        $k = ($k * 256) -bxor $val[$j]
        $val[$j] = [Math]::Floor([Double]($k / 24))
        $k = $k % 24
      }
      $key = $map[$k] + $key
      if (($i % 5) -eq 0 -and $i -ne 0) {$key = "-" + $key}
    }
  }
  end {$key}
}
```
