---
pid:            1197
author:         Eli Sagie
title:          
date:           2009-07-07 02:16:11
format:         posh
parent:         1196

---

# 

### [download](Scripts\1197.ps1) - [parent](Scripts\1196.md)

Redirecting script to both console and file

```posh
Coresponding to the Scripting Guy blog "How Can I Both Save Information in a File and Display It on the Screen?"
(http://blogs.technet.com/heyscriptingguy/archive/2009/07/07/hey-scripting-guy-how-can-i-both-save-information-in-a-file-and-display-it-on-the-screen.aspx):
My comment is:
All of the above is cool but can't work if you want your Write-Host or Write-Debug to be redirected to file as well as printing to console.

Maybe the Scripting Guy can explain why (AFAIK these cmdlets are already redirecting their output).

so these examples don't work!:

Write-Debug "blablabla" > File.txt

Write-Debug "blablabla" | Out-File -filepath C:\File.txt

Write-Debug "blablabla" | Tee -filepath C:\File.txt

so here's the function I finally use:

Function WriteToDebug ([string]$DebugMessage)

{

$ScriptOut = ((Get-Date -format G )  + "`t$DebugMessage" )

Out-File -FilePath $LogFileDebug -Append -InputObject $ScriptOut

Write-Debug "$ScriptOut"

}

Where i replaced every Write-Debug in the script to WriteToDebug.
```
